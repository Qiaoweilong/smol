(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[623],{49071:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chop-shop",function(){return n(86746)}])},86746:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var r=n(47568),s=n(828),c=n(34051),a=n.n(c),o=n(85893),i={src:"/_next/static/media/coconut-trophy.477f628d.png",height:36,width:36,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAJ1BMVEVMaXEDBhtcPy5MMyY5Jh8AABo5JSFoRi52UjYkFxdALSdXPjAsJCx0jOihAAAADXRSTlMAHPz8+wyb/v6bm5scBh+DOAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADdJREFUCJkti0kKADEMw5Q4TZfp/99bDOOTEDJABN74Ms8ATi5lw1WtOSsICwOdJW3HrdqO//sDHbwAzCxzdBAAAAAASUVORK5CYII="},l=n(81516);function d(e){var t=e.imageSrc,n=e.image,r=e.text,s=e.isSelected,c=e.isDisabled,a=e.onClick;return(0,o.jsxs)("div",{className:"flex items-center justify-center flex-col border rounded w-32 sm:w-40 ".concat(s?"border-purple-primary":"border-gray-secondary"," ").concat(c?"cursor-not-allowed":"cursor-pointer"),onClick:function(){c||a()},children:[(0,o.jsxs)("div",{className:"flex h-24 items-center relative ".concat(c?"blur-[2px]":""),children:[t&&(0,o.jsx)("img",{className:"px-6",alt:"Vehicle",src:t}),!t&&n&&n,c&&(0,o.jsx)("div",{className:"absolute flex w-full items-center justify-center",children:(0,o.jsx)(l.Z,{color:"white",width:20})})]}),(0,o.jsx)("div",{className:"flex text-white uppercase w-full justify-center ".concat(s?"bg-purple-primary":"bg-gray-secondary"," "),children:r})]})}function u(e){var t=e.colors,n=e.selectedSkin,r=e.selectedColor,s=e.pointsLeft,c=e.onClick;return(0,o.jsxs)("div",{className:"grid gap-4 grid-cols-2 overflow-y-scroll",children:[n&&(0,o.jsx)("div",{children:(0,o.jsx)(d,{imageSrc:"/chop-shop/traits/".concat(n.upgradeId,".png"),text:"Default",isSelected:!r,isDisabled:!1,onClick:function(){return c(void 0)}})}),t.map((function(e,t){return(0,o.jsx)("div",{children:(0,o.jsx)(d,{imageSrc:"/chop-shop/traits/".concat(e.upgradeId,".png"),text:e.isUnlocked?"OWNED":"".concat(e.price," Points"),isSelected:(null===r||void 0===r?void 0:r.upgradeId)===e.upgradeId,isDisabled:!e.isUnlocked&&e.price>s+((null===r||void 0===r?void 0:r.price)||0),onClick:function(){return c(e)}})},t)}))]})}function p(e){var t=e.skins,n=e.selectedSkin,r=e.selectedVehicle,s=e.pointsLeft,c=e.onClick;return(0,o.jsxs)("div",{className:"grid gap-4 grid-cols-2 overflow-y-scroll",children:[(0,o.jsx)("div",{children:(0,o.jsx)(d,{imageSrc:"https://sfo3.digitaloceanspaces.com/playgrounds/smolverse/transparent_full_car/smolcars/".concat(null===r||void 0===r?void 0:r.tokenId,".png"),text:"Default",isSelected:!n,isDisabled:!1,onClick:function(){return c(void 0)}})}),t.map((function(e,t){return(0,o.jsx)("div",{children:(0,o.jsx)(d,{imageSrc:"/chop-shop/traits/".concat(e.upgradeId,".png"),text:e.isUnlocked?"OWNED":"".concat(e.price," Points"),isSelected:(null===n||void 0===n?void 0:n.upgradeId)===e.upgradeId,isDisabled:!e.isUnlocked&&e.price>s+((null===n||void 0===n?void 0:n.price)||0),onClick:function(){return c(e)}})},t)}))]})}function f(e){var t=e.traits,n=e.selectedTraits,r=e.pointsLeft,s=e.onClick,c=t.find((function(e){return n.find((function(t){var n=t.upgradeId;return e.upgradeId===n}))}));return(0,o.jsx)("div",{className:"flex flex-wrap gap-2 overflow-y-scroll",children:t.map((function(e,t){return(0,o.jsx)("div",{children:(0,o.jsx)(d,{imageSrc:"/chop-shop/traits/".concat(e.upgradeId,".png"),text:e.isUnlocked?"OWNED":"".concat(e.price," Points"),isSelected:(null===c||void 0===c?void 0:c.upgradeId)===e.upgradeId,isDisabled:!e.isUnlocked&&e.price>r+((null===c||void 0===c?void 0:c.price)||0),onClick:function(){return s(e)}})},t)}))})}var x=n(67294),m=function(e){var t=e.vehicle,n=e.skinId,r=e.colorId,s=e.selectedTraitIds,c=e.extraClassName,a=(0,x.useMemo)((function(){return t?n&&"0"!==n?"/chop-shop/traits/".concat(r&&"0"!==r?r:n,".png"):t.image:"https://sfo3.digitaloceanspaces.com/playgrounds/smolverse/transparent_full_car/smolcars/1.png"}),[t,n,r]),i=(0,x.useMemo)((function(){var e;if(!t)return"";var n=null===(e=t.attributes)||void 0===e?void 0:e.find((function(e){return"Backgrounds"===e.name}));return n?"/chop-shop/backgrounds/".concat(n.value.toLowerCase(),".png"):""}),[t]),l=(0,x.useMemo)((function(){return n&&"0"!==n?"/chop-shop/wheels/".concat(n,".png"):""}),[n]),d=(0,x.useMemo)((function(){return s.filter((function(e){return"0"!==e})).map((function(e){return"/chop-shop/traits/".concat(e,".png")}))}),[s]);return(0,o.jsxs)("div",{className:"relative flex ".concat(c),children:[(0,o.jsx)("img",{className:"max-w-[350px] ".concat(t?"z-10":"invisible"),src:a,alt:"car #".concat(null===t||void 0===t?void 0:t.tokenId," image")}),i&&(0,o.jsx)("img",{className:"absolute top-0 max-w-[350px] ".concat(c),src:i,alt:"car wheels"}),l&&(0,o.jsx)("img",{className:"absolute top-0 max-w-[350px] z-10 ".concat(c),src:l,alt:"car wheels"}),d.map((function(e,t){return(0,o.jsx)("img",{className:"absolute top-0 max-w-[350px] ".concat(c," z-10"),src:e,alt:"car trait"},t)}))]})};function h(e){var t=e.onClick,n=e.text,r=e.secondaryText,s=e.icon,c=e.variant,a=void 0===c?"primary":c,i=e.className;return(0,o.jsxs)("div",{onClick:t,className:"flex h-10 p-3 gap-2 bg-purple-".concat(a," rounded-md items-center ").concat(i),role:"button",children:[(0,o.jsx)("span",{className:"text-neutral-off font-bold hidden lg:block",children:n}),s&&(0,o.jsx)("span",{className:"flex justify-center ".concat("primary"===a?"text-white":"text-gray-light"),children:s}),r&&(0,o.jsx)("span",{className:"text-neutral-off text-xs font-bold rounded hidden sm:flex ".concat("primary"===a?"bg-purple-secondary":"bg-gray-primary","  py-1.5 px-2"),children:r})]})}function g(e){var t=e.vehicles,n=e.selectedVehicle,r=e.equippedUpgradesByVehicle,s=e.unstakeVehicle,c=e.onClick;return(0,o.jsx)("div",{className:"flex flex-wrap justify-center gap-2 max-h-96 overflow-y-scroll",children:t.map((function(e,t){var a=r[e.tokenId];return(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(d,{image:(0,o.jsx)(m,{extraClassName:"h-24",vehicle:e,skinId:a.skin,colorId:a.color,selectedTraitIds:[a.backMod,a.frontMod,a.sideMod,a.topMod]}),text:"#".concat(e.tokenId),isSelected:(null===n||void 0===n?void 0:n.id)===e.id,onClick:function(){return c(e)}}),"Racing"===e.stakeLocation&&(0,o.jsx)("div",{className:"absolute top-0 w-full h-full flex items-center justify-center z-20",children:(0,o.jsx)(h,{className:"text-sm",text:"UNSTAKE",onClick:function(){return s(e)}})})]},t)}))})}var A=n(14924),v=n(26042),b=n(69396),k=n(63325),w=n(5506);function y(e){var t=e.isOpen,n=e.onClose,r=e.children;return(0,o.jsxs)(k.V,{open:t,onClose:n,className:"relative z-50",children:[(0,o.jsx)("div",{className:"fixed inset-0 bg-black/80","aria-hidden":"true"}),(0,o.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,o.jsxs)(k.V.Panel,{className:"mx-auto max-w-sm rounded bg-gray-primary border-2 border-gray-secondary",children:[(0,o.jsx)("div",{className:"flex justify-end",role:"button",onClick:n,children:(0,o.jsx)(w.Z,{className:"text-white h-6 bg-gray-secondary rounded-bl"})}),(0,o.jsx)("div",{className:"px-4 pt-2 pb-4",children:r})]})})]})}var S,j=n(49096),N=n(5152),M=n.n(N),C=n(52795),I=M()((function(){return Promise.all([n.e(868),n.e(180),n.e(232)]).then(n.bind(n,65753))}),{loadableGenerated:{webpack:function(){return[65753]}},ssr:!1}),T=42069,U=(S={},(0,A.Z)(S,1,{src:"/_next/static/media/first-trophy.90d2a1d5.png",height:98,width:96,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAP1BMVEVMaXFkQCdvUDplW11vbnhwXVZEKh4+RVEOBA28vsYAAACGcWWRlaCpn5ygoamssbuvtL6Nkp9kWV1iWFyzpp7pvivEAAAAFHRSTlMA/v7EXvPPCST4EvQl806cc6Chocx6uzwAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA9SURBVAiZFcVHEsAgDASwNbjSIfz/rRl0EeyIiHyGrUSJdGO6pqQ+MRZH8BpA4965AUCptbzhEf62fG82/EXqAdHEK/B+AAAAAElFTkSuQmCC"}),(0,A.Z)(S,2,{src:"/_next/static/media/second-trophy.4e45aaa3.png",height:79,width:30,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAICAMAAAALMbVOAAAANlBMVEVMaXHW2N3DxsxVOCQwNkjL0Nm0usadoKqosL6xuca0u8mPlaNFODlqVEm/xdLw9fyeko5SMx5XK1rFAAAADnRSTlMAVZ+0GeCS4n7KhrJt/K9+Ia0AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAkSURBVAiZY2AW5GHgFWBnYOXnYmDjY2Hg4GQAY0YmBgZudhYADbQAtuOA8sYAAAAASUVORK5CYII="}),(0,A.Z)(S,3,{src:"/_next/static/media/third-trophy.73682720.png",height:80,width:26,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAICAMAAAALMbVOAAAALVBMVEVRNSYjKlUjK1pJMSUDBGYtN24jLWApM2MiLmMpMmQwME0rKkQ8JR0oMmVmRS1gXZNLAAAADnRSTlP7TDqRByJmmIZxksioLveiGsQAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAkSURBVAiZBcGHDQAgEMSw3HeK2H9cbKKTbMNKSIuKYfuBB879B0UAej8+P0EAAAAASUVORK5CYII="}),(0,A.Z)(S,T,i),S),E=function(e){var t,n=e.isOpen,c=e.trophiesBalances,l=e.trophiesExchangeValue,d=e.exchangeTrophies,u=e.redeem,p=e.onClose,f=(0,x.useState)(!1),m=f[0],g=f[1],k=(0,x.useState)((t={},(0,A.Z)(t,1,0),(0,A.Z)(t,2,0),(0,A.Z)(t,3,0),(0,A.Z)(t,T,0),t)),w=k[0],S=k[1],N=(0,s.Z)((0,C.Z)("magicExchange:showOnboarding",{defaultValue:"true"}),2),M=N[0],E=N[1],V=(0,x.useMemo)((function(){return m?[T]:[1,2,3]}),[m]),Z=(0,x.useMemo)((function(){return m?(1.312175572*w[42069]).toFixed(9):V.reduce((function(e,t){return e+w[t]*l[t]}),0)}),[w,l,V,m]),B=(0,x.useMemo)((function(){return V.map((function(e){return[e,w[e]]})).filter((function(e){var t=(0,s.Z)(e,2);t[0];return t[1]>0}))}),[w,V]),D=(0,x.useCallback)((function(){var e;S((e={},(0,A.Z)(e,1,0),(0,A.Z)(e,2,0),(0,A.Z)(e,3,0),(0,A.Z)(e,T,0),e)),g(!1),p()}),[p]);return(0,o.jsx)(y,{isOpen:n,onClose:function(){return D()},children:(0,o.jsxs)("div",{className:"flex flex-col space-y-4 p-6 pt-0",children:[(0,o.jsx)(I,{steps:[{target:"#magicSwitch",title:"Exchange MAGIC",content:"Toggle the switch to exchange coconuts for MAGIC"}],onClose:function(){return E("false")},enabled:n&&"true"===M}),(0,o.jsxs)("div",{className:"flex justify-end w-full space-x-2",children:[(0,o.jsx)("span",{className:" text-neutral-off font-bold uppercase",children:"$MAGIC"}),(0,o.jsx)("div",{id:"magicSwitch",children:(0,o.jsx)(j.r,{checked:m,onChange:function(){return g(!m)},className:"".concat(m?"bg-purple-primary":"bg-gray-300"," relative inline-flex h-6 w-11 items-center rounded-full"),children:(0,o.jsx)("span",{className:"".concat(m?"translate-x-6":"translate-x-1"," inline-block h-4 w-4 transform rounded-full bg-white transition")})})})]}),(0,o.jsx)("div",{className:"text-neutral-off text-md",children:m?"Convert your coconuts into $MAGIC":"Convert your trophies into coconuts"}),(0,o.jsx)("div",{className:"flex items-end",children:V.map((function(e){return(0,o.jsxs)("div",{className:"flex flex-col items-center flex-grow basis-0 space-y-1",children:[(0,o.jsx)("img",{src:U[e].src,alt:"trophy image"}),(0,o.jsxs)("span",{className:"text-neutral-off",children:["x ",c[e]]}),(0,o.jsx)("input",{value:w[e],min:0,max:c[e],onChange:function(t){var n=t.target;return S((0,b.Z)((0,v.Z)({},w),(0,A.Z)({},e,Number.parseInt(n.value,10))))},className:"w-20 bg-purple-darker border-gray-secondary text-neutral-off rounded-sm appearance-none",type:"number"})]},e)}))}),(0,o.jsxs)("div",{className:"flex text-neutral-off text-md self-center items-center space-x-1",children:[(0,o.jsxs)("span",{children:["You will receive ",Z]}),!m&&(0,o.jsx)("img",{src:i.src,alt:"coconuts"}),m&&(0,o.jsx)("span",{children:"$MAGIC"})]}),(0,o.jsx)(h,{className:"w-full justify-center",text:"CONVERT",isDisabled:0===B.length,onClick:(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,m){e.next=8;break}return e.next=6,d(B.map((function(e){return(0,s.Z)(e,1)[0]})),B.map((function(e){var t=(0,s.Z)(e,2);t[0];return t[1]})));case 6:e.next=10;break;case 8:return e.next=10,u(T,w[42069]);case 10:D(),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(2);case 15:case"end":return e.stop()}}),e,null,[[2,13]])})))})]})})};function V(e){var t=e.width,n=e.height;return(0,o.jsx)("svg",{width:t,height:n,viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.3656 0.234315C11.678 0.546734 11.678 1.05327 11.3656 1.36569L4.96559 7.76569C4.65317 8.0781 4.14664 8.0781 3.83422 7.76569L0.634217 4.56569C0.321797 4.25327 0.321797 3.74673 0.634217 3.43431C0.946636 3.1219 1.45317 3.1219 1.76559 3.43431L4.3999 6.06863L10.2342 0.234315C10.5466 -0.0781049 11.0532 -0.0781049 11.3656 0.234315Z",fill:"currentColor"})})}function Z(e){var t=e.steps,n=e.currentStep;return(0,o.jsx)("div",{className:"flex justify-between",children:t.map((function(e,r){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsxs)("div",{className:"relative flex items-center w-full justify-center",children:[r<n&&(0,o.jsx)("div",{className:"flex rounded-full z-10 w-6 h-6 bg-green-team items-center justify-center text-neutral-off",children:(0,o.jsx)(V,{width:16,height:16})}),r===n&&(0,o.jsx)("div",{className:"rounded-full z-10 w-6 h-6 border-2 border-neutral-off bg-[#1A1A4C]"}),r>n&&(0,o.jsx)("div",{className:"rounded-full z-10 w-6 h-6 border-2 border-gray-darker bg-[#1A1A4C]"}),r!==t.length-1&&(0,o.jsx)("div",{className:"absolute bg-white h-px w-1/2 right-0 ".concat(n>r?"bg-green-400":"bg-gray-darker")}),0!==r&&(0,o.jsx)("div",{className:"absolute h-px w-1/2 left-0 ".concat(n>=r?"bg-green-400":"bg-gray-darker")})]}),(0,o.jsx)("p",{className:"text-center leading-4 text-sm mt-3 ".concat(n<r?"text-gray-darker":"text-white"),children:e.label})]},r)})}))})}var B,D=x.forwardRef((function(e,t){return x.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),x.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}))})),R=n(29815);!function(e){e[e.Skin=0]="Skin",e[e.Color=1]="Color",e[e.TopMod=2]="TopMod",e[e.FrontMod=3]="FrontMod",e[e.SideMod=4]="SideMod",e[e.BackMod=5]="BackMod"}(B||(B={}));var O=n(44251),L=n(33283),F=n(39666),G=n(33368),K=n(96486),Y=n(86501),_=n(88767),q=n(67976),z=[1,2,3,42069],P=function(){var e=(0,q.mA)().address,t=(0,O.r)(e).smolCars,n=(0,x.useState)([]),s=n[0],c=n[1],o=(0,x.useState)(),i=o[0],l=o[1],d=(0,x.useState)(0),u=d[0],p=d[1],f=(0,x.useState)(),m=f[0],h=f[1],g=(0,x.useState)(),A=g[0],k=g[1],w=(0,x.useState)([]),y=w[0],S=w[1],j=(0,x.useState)(1),N=j[0],M=j[1],C=(0,G.xx)(),I=G.re[C],T=I.smolChopShop,U=I.racingRedemption,E=(0,_.useQuery)(["upgrades"],(function(){return L.Bn.getUpgrades()}),{refetchInterval:3e4,keepPreviousData:!0}).data,V=(0,G.n4)({contractName:"smolChopShop",functionName:"getAllUnlockedUpgrades",args:i?[i.collectionId,i.tokenId]:[],enabled:!!i}),Z=(0,G.Zr)(s.map((function(e){return{contractName:"smolChopShop",functionName:"getEquippedUpgrades",args:[e.collectionId,e.tokenId]}}))),D=(0,x.useMemo)((function(){return Object.fromEntries(s.map((function(e,t){if(!Z.data||0===Z.data.filter(Boolean).length)return[e.tokenId,{skin:"0",color:"0",topMod:"0",frontMod:"0",sideMod:"0",backMod:"0"}];var n=Z.data[t];return[e.tokenId,{skin:n.skin.toString(),color:n.color.toString(),topMod:n.topMod.toString(),frontMod:n.frontMod.toString(),sideMod:n.sideMod.toString(),backMod:n.backMod.toString()}]})))}),[Z,s]),P=(0,x.useMemo)((function(){return i?D[i.tokenId]:{skin:"0",color:"0",topMod:"0",frontMod:"0",sideMod:"0",backMod:"0"}}),[i,D]),J=function(e,t){var n=(0,x.useMemo)((function(){if(!e)return[];var n=t?t.map((function(e){return e.toString()})):[];return e.upgrades.filter((function(e){return e.forSale})).map((function(e){return(0,b.Z)((0,v.Z)({},e),{price:Number.parseInt(e.price,10),isUnlocked:n.includes(e.upgradeId)})}))}),[e,t]);return{skins:(0,x.useMemo)((function(){var e=n.filter((function(e){return e.upgradeType===B.Skin}))||[],t=e.find((function(e){return e.isUnlocked}));return t?[t]:e}),[n]),colors:(0,x.useMemo)((function(){return n.filter((function(e){return e.upgradeType===B.Color}))||[]}),[n]),topMods:(0,x.useMemo)((function(){return n.filter((function(e){return e.upgradeType===B.TopMod}))||[]}),[n]),frontMods:(0,x.useMemo)((function(){return n.filter((function(e){return e.upgradeType===B.FrontMod}))||[]}),[n]),sideMods:(0,x.useMemo)((function(){return n.filter((function(e){return e.upgradeType===B.SideMod}))||[]}),[n]),backMods:(0,x.useMemo)((function(){return n.filter((function(e){return e.upgradeType===B.BackMod}))||[]}),[n])}}(E,V.data),Q=J.skins,W=J.colors,H=J.topMods,X=J.frontMods,$=J.sideMods,ee=J.backMods,te=(0,G.n4)({contractName:"smolTrophies",functionName:"balanceOfBatch",args:[z.map((function(){return e})),z],enabled:!!e}),ne=(0,G.Zr)(z.map((function(e){return{contractName:"smolChopShop",functionName:"trophyExchangeValue",args:[e]}}))),re=(0,G.n4)({contractName:"smolTrophies",functionName:"isApprovedForAll",args:[e,T],enabled:!!e}),se=(0,G.n4)({contractName:"smolTrophies",functionName:"isApprovedForAll",args:[e,U],enabled:!!e}),ce=(0,G.t0)({contractName:"smolChopShop",functionName:"buyUpgradeBatch",onSuccess:function(){V.refetch()}}),ae=(0,G.t0)({contractName:"smolChopShop",functionName:"equipUpgrades",onSuccess:function(){Z.refetch()}}),oe=(0,G.t0)({contractName:"smolChopShop",functionName:"exchangeTrophiesBatch",onSuccess:function(){te.refetch()}}),ie=(0,G.t0)({contractName:"racingRedemption",functionName:"redeem",onSuccess:function(){te.refetch()}}),le=(0,G.t0)({contractName:"smolTrophies",functionName:"setApprovalForAll",onSuccess:function(){re.refetch()}}),de=(0,G.t0)({contractName:"smolRacing",functionName:"unstakeVehicles",args:[]}),ue=(0,x.useCallback)(function(){var e=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,F.hy)(t.collectionId)?[[],[Number(t.tokenId)]]:[[Number(t.tokenId)],[]],e.next=4,de.writeAsync({recklesslySetUnpreparedArgs:n});case 4:c(s.map((function(e){return e.tokenId===t.tokenId?(0,b.Z)((0,v.Z)({},e),{stakeLocation:void 0}):e}))),Y.Am.success("Successfully Unstaked!"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Y.Am.error("Transaction Reverted");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[de,s]),pe=(0,x.useCallback)(function(){var e=(0,r.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,se.data){e.next=4;break}return e.next=4,le.writeAsync({recklesslySetUnpreparedArgs:[U,!0]});case 4:return e.next=6,ie.writeAsync({recklesslySetUnpreparedArgs:[t,n]});case 6:Y.Am.success("Successfully Exchanged!"),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),Y.Am.error("Transaction Reverted"),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),[ie,le,U,se]),fe=(0,x.useCallback)(function(){var e=(0,r.Z)(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,re.data){e.next=4;break}return e.next=4,le.writeAsync({recklesslySetUnpreparedArgs:[T,!0]});case 4:return e.next=6,oe.writeAsync({recklesslySetUnpreparedArgs:[t,n]});case 6:Y.Am.success("Successfully Exchanged!"),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),Y.Am.error("Transaction Reverted"),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),[oe,le,T,re]),xe=(0,x.useMemo)((function(){return[m,A].concat((0,R.Z)(y)).filter((function(e){return e&&!e.isUnlocked}))}),[y,m,A]),me=(0,x.useCallback)((0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(re.data){e.next=3;break}return e.next=3,le.writeAsync({recklesslySetUnpreparedArgs:[T,!0]});case 3:return e.next=5,ce.writeAsync({recklesslySetUnpreparedArgs:[xe.map((function(){return i.collectionId})),xe.map((function(){return i.tokenId})),xe.map((function(e){return e.upgradeId}))]});case 5:h((0,b.Z)((0,v.Z)({},m),{isUnlocked:!0})),k((0,b.Z)((0,v.Z)({},A),{isUnlocked:!0})),S(y.map((function(e){return(0,b.Z)((0,v.Z)({},e),{isUnlocked:!0})})));case 8:case"end":return e.stop()}}),e)}))),[ce,m,A,y,i,le,T,re,xe]),he=(0,x.useMemo)((function(){return Object.fromEntries(z.map((function(e,t){return[e,ne.data&&ne.data[t]?ne.data[t].toNumber():0]})))}),[ne]),ge=(0,x.useMemo)((function(){return Object.fromEntries(z.map((function(e,t){return[e,te.data&&te.data[t]?te.data[t].toNumber():0]})))}),[te]),Ae=(0,x.useMemo)((function(){return ge[42069]}),[ge]),ve=(0,x.useMemo)((function(){var e=(0,K.sum)(xe.map((function(e){return e.price})));return Ae-e}),[xe,Ae]),be=(0,x.useMemo)((function(){return(0,R.Z)(H).concat((0,R.Z)(X),(0,R.Z)($),(0,R.Z)(ee)).filter((function(e){return e.validSkinId===(null===m||void 0===m?void 0:m.upgradeId)}))}),[H,X,$,ee,m]),ke=(0,x.useMemo)((function(){return be.filter((function(e){return e.upgradeType===N}))}),[be,N]),we=(0,x.useMemo)((function(){return[{id:B.TopMod,name:"Top"},{id:B.FrontMod,name:"Front"},{id:B.SideMod,name:"Side"},{id:B.BackMod,name:"Back"}].filter((function(e){return be.some((function(t){return t.upgradeType===e.id}))}))}),[be]),ye=(0,x.useMemo)((function(){switch(u){case 1:return{title:"Vehicle Skin",subtitle:"Select which vehicle to upgrade to",buttonText:m?"next":"apply default",buttonAction:(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=4;break}p(2),e.next=14;break;case 4:if("0"===P.skin){e.next=14;break}return e.prev=5,e.next=8,ae.writeAsync({recklesslySetUnpreparedArgs:[[null===i||void 0===i?void 0:i.collectionId],[null===i||void 0===i?void 0:i.tokenId],[{skin:"0",color:"0",topMod:"0",frontMod:"0",sideMod:"0",backMod:"0"}]]});case 8:Y.Am.success("Upgrades Unequipped"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),Y.Am.error("Transaction Reverted");case 14:case"end":return e.stop()}}),e,null,[[5,11]])}))),buttonDisabled:"0"===P.skin&&!m};case 2:return{title:"Vehicle Colour",subtitle:"Select your colour",buttonText:"next",buttonAction:(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(3);case 1:case"end":return e.stop()}}),e)})))};case 3:return{title:"Vehicle Traits",subtitle:0===we.length?"This skin has no extra traits":"Select which traits you'd like",buttonText:xe.length>0?"buy upgrades":"equip upgrades",buttonAction:(0,r.Z)(a().mark((function e(){var t,n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(xe.length>0)){e.next=7;break}return e.next=4,me();case 4:Y.Am.success("Upgrades Claimed"),e.next=11;break;case 7:return e.next=10,ae.writeAsync({recklesslySetUnpreparedArgs:[[null===i||void 0===i?void 0:i.collectionId],[null===i||void 0===i?void 0:i.tokenId],[{skin:(null===m||void 0===m?void 0:m.upgradeId)||"0",color:(null===A||void 0===A?void 0:A.upgradeId)||"0",topMod:(null===(t=y.find((function(e){return e.upgradeType===B.TopMod})))||void 0===t?void 0:t.upgradeId)||"0",frontMod:(null===(n=y.find((function(e){return e.upgradeType===B.FrontMod})))||void 0===n?void 0:n.upgradeId)||"0",sideMod:(null===(r=y.find((function(e){return e.upgradeType===B.SideMod})))||void 0===r?void 0:r.upgradeId)||"0",backMod:(null===(s=y.find((function(e){return e.upgradeType===B.BackMod})))||void 0===s?void 0:s.upgradeId)||"0"}]]});case 10:Y.Am.success("Upgrades Equipped");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),Y.Am.error("Transaction Reverted");case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))};default:return{title:"Your Vehicles",subtitle:"Select which vehicle to upgrade",buttonText:i?"Next":"Select a Vehicle",buttonAction:(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i&&p(1);case 1:case"end":return e.stop()}}),e)}))),buttonDisabled:!i}}}),[u,i,m,we,xe,me,ae,P,A,y]),Se=(0,x.useMemo)((function(){return W.filter((function(e){return e.validSkinId===(null===m||void 0===m?void 0:m.upgradeId)}))}),[W,m]),je=(0,x.useCallback)((function(e){var t=y.filter((function(t){var n=t.upgradeId;return e.upgradeId!==n}));t.length!==y.length?S(t):S((0,R.Z)(y.filter((function(t){var n=t.upgradeId,r=t.upgradeType;return e.upgradeId!==n&&e.upgradeType!==r}))).concat([e]))}),[y,S]);return(0,x.useEffect)((function(){we.length>0&&M(we[0].id)}),[we]),(0,x.useEffect)((function(){c(t)}),[t]),{stepConfig:ye,currentStep:u,smolCars:s,selectedVehicle:i,unlockedUpgrades:V,skins:Q,selectedSkin:m,pointsLeft:ve,skinColors:Se,selectedColor:A,traitTypes:we,selectedTraitTypeId:N,selectedSkinTraitsForSelectedType:ke,selectedTraits:y,trophiesBalances:ge,trophiesExchangeValue:he,selectedVehicleEquippedUpgrades:P,equippedUpgradesByVehicle:D,redeem:pe,unstakeVehicle:ue,exchangeTrophies:fe,buyUpgrades:me,setSelectedTraitTypeId:M,setSelectedVehicle:l,setSelectedSkin:h,setSelectedColor:k,setSelectedTraits:S,changeSelectedTraits:je,setCurrentStep:p}},J=M()((function(){return Promise.all([n.e(868),n.e(180),n.e(232)]).then(n.bind(n,65753))}),{loadableGenerated:{webpack:function(){return[65753]}},ssr:!1}),Q=[{label:"Select Vehicle"},{label:"Select Skin"},{label:"Select Color"},{label:"Select Traits"}],W=function(){var e=P(),t=e.stepConfig,n=e.currentStep,c=e.smolCars,l=e.selectedVehicle,d=e.skins,h=e.selectedSkin,A=e.pointsLeft,v=e.skinColors,b=e.selectedColor,k=e.traitTypes,w=e.selectedTraitTypeId,y=e.selectedSkinTraitsForSelectedType,S=e.selectedTraits,j=e.trophiesBalances,N=e.trophiesExchangeValue,M=e.equippedUpgradesByVehicle,I=e.selectedVehicleEquippedUpgrades,T=e.redeem,U=e.unstakeVehicle,V=e.setSelectedVehicle,B=e.setSelectedSkin,R=e.setSelectedColor,O=e.setSelectedTraits,L=e.setSelectedTraitTypeId,F=e.changeSelectedTraits,G=e.setCurrentStep,K=e.exchangeTrophies,Y=(0,x.useState)(!1),_=Y[0],q=Y[1],z=(0,s.Z)((0,C.Z)("chopShop:showOnboarding",{defaultValue:"true"}),2),W=z[0],H=z[1];return(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"pt-32 px-0 max-w-[1300px] 3xl:max-w-[1460px] mx-auto",children:(0,o.jsx)("div",{className:"flex justify-between flex-col w-full mx-auto md:w-max 3xl:flex-row 3xl:w-full 3xl:mx-0 px-4 lg:px-0 3xl:items-end",children:(0,o.jsx)("h1",{className:"w-max h-max text-xl sm:text-4xl text-white uppercase font-rubik font-bold p-5 bg-gray-primary mx-auto 3xl:mx-0 3xl:mr-auto 3xl:mb-auto shadow-dark-sharp md:text-5.5xl",children:"Chop Shop"})})}),(0,o.jsxs)("div",{className:"flex flex-col relative items-center justify-center px-40 space-y-16",children:[(0,o.jsx)(J,{steps:[{target:"#coconutsExchangeButton",title:"Coconuts",content:"Exchange your trophies for coconuts and use them to claim skins, or MAGIC"},{target:"#currentStep",title:"Your Vehicle",content:"Select your favorite vehicles, buy, and equip your upgrades"}],onClose:function(){return H("false")},enabled:"true"===W}),(0,o.jsx)(E,{isOpen:_,trophiesBalances:j,trophiesExchangeValue:N,exchangeTrophies:K,redeem:T,onClose:function(){return q(!1)}}),(0,o.jsxs)("div",{className:"flex space-x-4 flex-wrap",children:[(0,o.jsxs)("div",{className:"flex flex-col rounded-lg w-[420px] bg-[#1A1A4CCC] overflow-y-auto",id:"currentStep",children:[(0,o.jsx)("div",{className:"py-3 text-center text-white bg-[#31315E] uppercase font-bold",children:t.title}),(0,o.jsxs)("div",{className:"flex flex-col justify-around p-4 space-y-6 bg-purple-darker",children:[(0,o.jsx)("p",{className:"text-white text-center",children:t.subtitle}),(0,o.jsxs)("div",{className:"flex justify-center items-start h-72 overflow-y-scroll overflow-x-hidden",children:[0===n&&(0,o.jsx)(g,{vehicles:c,selectedVehicle:l,equippedUpgradesByVehicle:M,unstakeVehicle:U,onClick:function(e){V(e),B(void 0),R(void 0),O([])}}),1===n&&(0,o.jsx)(p,{skins:d,selectedSkin:h,selectedVehicle:l,pointsLeft:A,onClick:function(e){B(e),R(void 0),O([])}}),2===n&&(0,o.jsx)(u,{colors:v,selectedColor:b,selectedSkin:h,pointsLeft:A,onClick:function(e){return R(e)}}),3===n&&(0,o.jsxs)("div",{className:"flex flex-col px-3 gap-6",children:[(0,o.jsx)("div",{className:"flex gap-2 justify-center",children:k.map((function(e,t){return(0,o.jsx)("div",{className:"text-center border-2 w-20 p-2 border-gray-secondary rounded text-[#8D8DA6] text-sm font-medium uppercase ".concat(e.id===w?"bg-purple-primary border-purple-primary text-neutral-off":""),role:"button",onClick:function(){return L(e.id)},children:e.name},t)}))}),0===k.length&&(0,o.jsx)(D,{className:"text-orange-team w-1/2 self-center"}),(0,o.jsx)(f,{traits:y,selectedTraits:S,pointsLeft:A,onClick:function(e){F(e)}})]})]}),(0,o.jsx)("div",{className:"w-full px-0 sm:px-10",children:(0,o.jsx)(Z,{steps:Q,currentStep:n})}),(0,o.jsxs)("div",{className:"flex space-x-4",children:[n>0&&(0,o.jsx)("button",{className:"text-white bg-[#484870] uppercase font-semibold rounded-md min-w-[80px]",onClick:function(){n>0&&G(n-1)},children:"Back"}),(0,o.jsx)("button",{className:"text-white uppercase font-semibold w-full p-4 rounded-md ".concat(t.buttonDisabled?"bg-[#484870]":"bg-[#7D50E6]"),disabled:t.buttonDisabled,onClick:(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.buttonAction();case 1:case"end":return e.stop()}}),e)}))),children:t.buttonText})]})]})]}),(0,o.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,o.jsx)("div",{className:"flex space-x-4",id:"coconutsExchangeButton",children:(0,o.jsxs)("div",{className:"flex flex-col flex-grow basis-0 bg-[#7D50E6] rounded-md p-2.5",role:"button",onClick:function(){return q(!0)},children:[(0,o.jsx)("p",{className:"text-center text-neutral-off uppercase font-semibold my-2 mt-1",children:"Coconuts"}),(0,o.jsxs)("div",{className:"flex items-center justify-center h-full w-full bg-[#8A62E9] rounded-md py-3",children:[(0,o.jsx)("h4",{className:"text-center text-neutral-off text-4xl font-semibold",children:A}),(0,o.jsx)("img",{src:i.src,alt:"coconuts"})]}),(0,o.jsx)("p",{className:"text-center text-neutral-off font-semibold text-sm mt-1",children:"Click here to exchange coconuts"})]})}),(0,o.jsxs)("div",{className:"flex flex-col flex-grow rounded items-center bg-purple-darker self-start",children:[(0,o.jsx)("span",{className:"text-center text-neutral-off font-bold py-2 uppercase w-full bg-gray-primary rounded-t",children:"Preview"}),(0,o.jsx)(m,{vehicle:l,skinId:(null===h||void 0===h?void 0:h.upgradeId)||I.skin,colorId:(null===b||void 0===b?void 0:b.upgradeId)||I.color,selectedTraitIds:0!==S.length?S.map((function(e){return e.upgradeId})):[I.backMod,I.frontMod,I.sideMod,I.topMod]})]})]})]})]})]})}}},function(e){e.O(0,[662,915,757,25,998,774,888,179],(function(){return t=49071,e(e.s=t);var t}));var t=e.O();_N_E=t}]);